<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ahoron | Instructor Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(-45deg, #ffcce6, #ffd6a5, #b8e1ff, #c1f7dc);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      min-height: 100vh;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .card {
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      border: 2px solid rgba(255,255,255,0.5);
      backdrop-filter: blur(5px);
      background: rgba(255,255,255,0.8) !important;
    }

    .card:hover {
      transform: scale(1.05) translateY(-5px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
    }

    nav {
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }

    h1 {
      font-family: 'Fredoka One', cursive;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      background: linear-gradient(45deg, #6a11cb 0%, #2575fc 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: hueRotate 6s infinite alternate;
    }

    @keyframes hueRotate {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }

    #welcomeMessage {
      background: linear-gradient(45deg, #ff00cc, #3333ff);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 10px rgba(255,255,255,0.3);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    button {
      transition: all 0.3s ease;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 7px 14px rgba(0, 0, 0, 0.1);
    }

    .bg-gradient-to-r {
      transition: all 0.5s ease;
    }

    .bg-gradient-to-r:hover {
      background-size: 200% auto;
    }

    .emoji-icon {
      font-size: 1.5rem;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }

    #msgNotificationBadge {
      animation: pulseBadge 1.5s infinite;
    }

    @keyframes pulseBadge {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
</style>
</head>

<body class="min-h-screen text-gray-800">

  <nav class="py-4 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 flex justify-between items-center">
      <h1 class="text-3xl font-extrabold">Instructor Panel</h1>
      <div class="space-x-4">
        <a href="i_profile.html" class="text-gray-700 font-semibold hover:text-indigo-600 transition-colors duration-300">Profile</a>
        <a href="#" class="text-gray-700 font-semibold hover:text-indigo-600 transition-colors duration-300">Settings</a>
        <a href="login.html" class="bg-gradient-to-r from-indigo-500 to-pink-500 text-white px-4 py-2 rounded-xl font-semibold hover:from-pink-500 hover:to-indigo-500 transition-all duration-500 hover:bg-gradient-to-l">Logout</a>
      </div>
    </div>
  </nav>

  <div class="max-w-7xl mx-auto text-center py-12">
    <h2 id="welcomeMessage" class="text-5xl font-extrabold mb-4">Welcome Instructor!
    </h2>
    <p class="text-lg text-gray-700">Manage your communication, clubs, and chat with students here.</p>
  </div>

  <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-6 pb-20">

    <div
      class="card bg-white rounded-2xl shadow-xl p-6 hover:shadow-2xl transition duration-300 cursor-pointer relative">
      <div class="flex items-center space-x-4">
        <div class="emoji-icon bg-gradient-to-r from-yellow-400 to-red-400 p-3 rounded-full text-white">‚úâÔ∏è</div>
        <h3 class="text-xl font-semibold">Messages</h3>
      </div>
      <p class="mt-4 text-sm text-gray-600">View messages from students and admins.</p>

      <div id="msgNotificationBadge"
        class="absolute top-4 right-6 bg-red-600 text-white rounded-full px-2 py-1 text-xs font-bold hidden">
        0
      </div>

      <button id="viewMessagesBtn"
        class="mt-6 w-full bg-yellow-400 text-white py-2 rounded-lg hover:bg-yellow-500 transition">
        View Messages
      </button>
    </div>

    <div class="card bg-white rounded-2xl shadow-xl p-6 hover:shadow-2xl transition duration-300 cursor-pointer">
      <div class="flex items-center space-x-4">
        <div class="emoji-icon bg-gradient-to-r from-yellow-400 to-red-400 p-3 rounded-full text-white">üë®‚Äçüè´</div>
        <h3 class="text-xl font-semibold">Chat with Students</h3>
      </div>
      <p class="mt-4 text-sm text-gray-600">Provide support, mentoring, and answer queries.</p>
      <button onclick="window.location.href='i_chat.html'"
        class="mt-6 w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 transition">Start Chat</button>
    </div>
    <div class="card bg-white rounded-2xl shadow-lg p-6 hover:shadow-2xl transition duration-300 cursor-pointer">
      <div class="flex items-center space-x-4">
        <div class="emoji-icon bg-gradient-to-r from-yellow-400 to-red-400 p-3 rounded-full text-white">
          üéì
        </div>
        <h3 class="text-xl font-semibold">Clubs</h3>
      </div>
      <p class="mt-4 text-sm text-gray-600">Join student clubs that suit your interests.</p>
      <button onclick="window.location.href='club.html'"
        class="mt-6 w-full bg-indigo-500 text-white py-2 rounded-lg hover:bg-indigo-600 transition">Explore Clubs</button>
    </div>
  </div>

  <script>
  console.log("Instructor dashboard loaded");
console.log("Instructor ID from localStorage:", localStorage.getItem('instructor_id'));


 document.addEventListener("DOMContentLoaded", async () => {
    const instructorId = localStorage.getItem("instructor_id");

    if (instructorId) {
      try {
        const response = await fetch(`http://localhost:3000/api/instructor/${instructorId}`);
        if (!response.ok) throw new Error("Failed to fetch instructor");

        const data = await response.json();
       document.getElementById("welcomeMessage").textContent = `Welcome, ${data.name}!`;


      } catch (err) {
        console.error("Error:", err);
      }
    }
  });
  document.getElementById('viewMessagesBtn').addEventListener('click', () => {
    window.location.href = 'i_messages.html';
  });

  async function fetchUnreadMessagesCount() {
    const instructorId = localStorage.getItem('instructor_id');
    if (!instructorId) return;

    try {
      const response = await fetch(`http://localhost:3000/api/instructor/${instructorId}/unread-messages-count`);
      const data = await response.json();

      const badge = document.getElementById('msgNotificationBadge');
      if (data.unreadCount > 0) {
        badge.textContent = data.unreadCount;
        badge.classList.remove('hidden');
      } else {
        badge.classList.add('hidden');
      }
    } catch (error) {
      console.error('Error fetching unread messages count:', error);
    }
  }

  fetchUnreadMessagesCount();
  setInterval(fetchUnreadMessagesCount, 30000);
</script>


</body>

</html>